<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>LEX-Template</title>
<style>
.myForm{
display:table;
padding: 5px 5px;
margin: 8px;
}
.inputDiv {
	padding: 5px 5px;
	margin: 8px;
	display:table-row;
}
label{
display:table-cell;
}
input{
display:table-cell;
}
.errorMsg {
	color: red;
	margin-top: 5px;
}
</style>

</head>

<body>
	
	<div id="myForm">
		<div class="inputDiv">
			<label for="Name">Name:</label>
			<input id="username" type="text" name="username"
				onblur="validationform()" placeholder="Customer Name" />
			<div id="usernamemsg" class="errorMsg"></div>
		</div>
		<div class="inputDiv">
			<label for="Designation">Designation:</label>
			<input id="designation" type="text" name="designation"
				onblur="validationform()" placeholder="Designation" />
			<div id="designationmsg" class="errorMsg"></div>
		</div>

		<div class="inputDiv">
			<label for="Email">Email:</label>
			<input id="email" type="text" name="email" onblur="validationform()"
				placeholder="Email" />
			<div id="emailmsg" class="errorMsg"></div>
		</div>

		<div class="inputDiv">
			<label for="Mobile">Mobile:</label>
			<input id="mobile" type="text" name="mobile"
				onblur="validationform()" placeholder="Mobile Number" />
			<div id="mobilemsg" class="errorMsg"></div>
		</div>

		<div class="inputDiv">
			<label for="AppointmentLink">AppointmentLink:</label>
			<input id="appointment" type="text" name="appointment"
				onblur="validationform()" placeholder="AppointmentLink" />
			<div id="appointmentmsg" class="errorMsg"></div>
		</div>

		<div class="inputDiv">
			<label for="ImageLink">ImageLink</label>
			<input type="text" id="image_input" accept="image/png, image/jpeg"
				onblur="validationform()" placeholder="Write Your Image Link" />
			<div id="imagemsg" class="errorMsg"></div>
		</div>

		<div class="inputDiv">
			<button type="button" onclick="sendInput()" id="preview">Preview</button>
		</div>
	</div>


	<div id="Template1" class="template1"
		style="position: relative; left: 350px; top: -150px">
		<table class="template1table1"
			style="min-width: 313px; margin: 0px; box-sizing: border-box; border-collapse: collapse; background-color: #ffffff;">
			<tr>
				<td class="table1image1"
					style="width: 125px; height: 156px; vertical-align: top; text-align: right;">
					<img src="#" id="image" class="table1image1set" width="125px"
					height="156px"
					style="width: 125px; height: 156px; font-size: 16px; color: #303030;" />
				</td>
				<td id="text" class="table1username"
					style="padding: 4px 0 0 24px; vertical-align: top">
					<p id="usernameResult" class="table1usernameResult"
						style="font-family: Arial, Helvetica, sans-serif; font-weight: 600; color: #006ec8; font-size: 20px; margin: 0 0 4px; line-height: 24px; letter-spacing: 0.8px;">
						<b style="font-weight: 600"></b>
					</p>
					<p id="designationResult" class="table1designationResult"
						style="font-family: Arial, Helvetica, sans-serif; color: rgba(48, 48, 48, 0.6); font-size: 16px; margin: 0 0 10px; font-weight: 400; line-height: 18px;"></p>
					<hr id="space" class="table1space" width="44px"
						style="width: 44px; border: 0; border-top: 1px solid #83838333; margin: 0 0 20px; max-width: 44px;" />
					<p class="table1emailResult"
						style="margin: 0 0 10px; font-family: Arial, Helvetica, sans-serif; color: #303030; font-size: 16px; font-weight: 400; line-height: 18px;">
						<a href="#" id="emailLink" class="table1emailLink" target="_self"
							style="font-family: Arial, Helvetica, sans-serif; color: #303030; font-size: 16px; font-weight: 400; line-height: 18px; text-decoration: none; cursor: pointer;">
							<span id="emailResult"></span>
						</a>
					</p>
					<p class="table1mobileResult"
						style="margin: 0 0 10px; font-family: Arial, Helvetica, sans-serif; color: #303030; font-size: 16px; font-weight: 400; line-height: 18px;">
						<a href="#" id="mobileLink" class="table1mobileLink"
							style="font-family: Arial, Helvetica, sans-serif; color: #303030; font-size: 16px; font-weight: 400; line-height: 18px; text-decoration: none; cursor: pointer;">
							<span id="mobileResult"></span>
						</a>
					</p>
					<p id="bookingappointment" class="table1bookappointment"
						style="margin: 0; font-family: Arial, Helvetica, sans-serif; color: #303030; font-size: 16px; font-weight: 400; line-height: 18px;">
						<a href="#" class="table1bookappointmentlink"
							id="bookappointmentlink" target="_blank"
							style="font-family: Arial, Helvetica, sans-serif; color: #303030; font-size: 16px; font-weight: 400; line-height: 18px; text-decoration: none; cursor: pointer;">Book
							appointment</a>
					</p>
				</td>
			</tr>
		</table>
		<br />
	</div>


	<button id="download-btn" onclick="downloadTemplate()"
		style="position: relative; left: 350px; top: -150px">
		Download</button>
</body>

<script>
document.getElementById("Template1").style.display = "none";
document.getElementById("download-btn").style.display = "none";
document.getElementById("preview").style.display="none";

async function validationform() {
    const name = document.getElementById("username").value;
    const designation = document.getElementById("designation").value;
    const email = document.getElementById("email").value;
    const mobile = document.getElementById("mobile").value;
    const appointmentvalidation = document.getElementById("appointment").value;
    const imagevalidation = document.getElementById("image_input").value;
    const imgurl = await isImgUrl(imagevalidation);
    

    const namemsg = document.getElementById("usernamemsg");
    const designationmsg = document.getElementById("designationmsg");
    const emailmsg = document.getElementById("emailmsg");
    const mobilemsg = document.getElementById("mobilemsg");
    const appointmentmsg = document.getElementById("appointmentmsg");
    const imagemsg = document.getElementById("imagemsg");

     let count = 0;
    var regName = /^[a-zA-Z- ]+$/;

    if (name == "" || name == null) {
      namemsg.textContent = "Username is required";
      return false;
    } else if (!name.match(regName)) {
      namemsg.textContent = "Name must be alphabets";
      return false;
    } else {
        count++;
      namemsg.textContent = "";
    }

    if (designation == "") {
      designationmsg.textContent = "Designation is required";
      return false;
    } else if (!designation.match(regName)) {
      designationmsg.textContent = "Designation must be alphabets";
      return false;
    } else {
        count++;
      designationmsg.textContent = "";

    }

    if (email == "" || email == null) {
      emailmsg.textContent = "Email is required";
      return false;
    } else if (
      !email.match((/^([A-Za-z\-\.])+([A-Za-z0-9_]{0,4})+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/))
    ) {
      emailmsg.textContent = "Please provide a valid email";
      return false;
    } else {
      count++;
      emailmsg.textContent = "";

    }

    if (mobile == "") {
      mobilemsg.textContent = "Mobile No is required";
      return false;
    } else if (mobile.length != 10) {
      mobilemsg.textContent = "Your mobile number should be of 10 digits";
      return false;
    } else if (isNaN(mobile)) {
      mobilemsg.textContent = "Mobile Number must be numeric";
      return false;
    } else if (
      mobile.charAt(0) != 9 &&
      mobile.charAt(0) != 8 &&
      mobile.charAt(0) != 7 &&
      mobile.charAt(0) != 6
    ) {
      mobilemsg.textContent = "Mobile Number should start from 9,8,7,6";
      return false;
    } else {
       count++;
      mobilemsg.textContent = "";

    }

    if (appointmentvalidation == "" || appointmentvalidation == null) {
      appointmentmsg.textContent = "URL is required";
      return false;
    } else {
        count++;
      appointmentmsg.textContent = "";

    }

    if (imagevalidation == "" || imagevalidation == null) {
      imagemsg.textContent = "Image URL is required";
      return false;
    } else {
         count++;
      imagemsg.textContent = "";
    }

    if(imgurl){
    	count++;
      imagemsg.textContent = "";
    }else{
      imagemsg.textContent = "The URL provided isn't an Image";
      return false;
    }

            if (count == 7) {
        	document.getElementById("preview").style.display="block";
            return true;
            }
  }

  function isImgUrl(imagevalidation) {
    const img = new Image();
    img.src = imagevalidation;
    return new Promise((resolve) => {
        img.onerror = () => resolve(false);
        img.onload = () => resolve(true);
      })
      .then(value => value)
      .catch(value => value);    
  }
  
  function sendInput(){
	  const name = document.getElementById("username").value;
	    const designation = document.getElementById("designation").value;
	    const email = document.getElementById("email").value;
	    const mobile = document.getElementById("mobile").value;
	    const image = document.getElementById("image_input").value;
	    const appointment = document.getElementById("appointment").value;
        
	    Template1.querySelector("#usernameResult").innerHTML = name;
	    Template1.querySelector("#designationResult").innerHTML = designation;
	    Template1.querySelector("#emailResult").innerHTML = email;
	    Template1.querySelector("#mobileResult").innerHTML = mobile;

	    const mobilelink = Template1.querySelector("#mobileLink");
	    const emaillink = Template1.querySelector("#emailLink");
	    Template1.querySelector("#image").src = image;
	    const bookappointmentlink = Template1.querySelector(
	      "#bookappointmentlink"
	    );
	    mobilelink.setAttribute("href", "tel:" + mobile);
	    emaillink.setAttribute("href", "mailto:" + email);
	    bookappointmentlink.setAttribute("href", appointment);
  
	  document.getElementById("Template1").style.display = "block";
	  document.getElementById("download-btn").style.display = "block";
  }
  function downloadTemplate() {
	    const name = document.getElementById("username").value;
	    const template = document.getElementById("Template1");
	    const downloadBtn = document.getElementById("download-btn");
	    const downloadContent = template.innerHTML;
	    const fileName = `${name}.html`;
	    const file = new Blob([downloadContent], {
	      type: "text/html"
	    });
	    const url = URL.createObjectURL(file);
	    const a = document.createElement("a");
	    a.href = url;
	    a.download = fileName;
	    document.body.appendChild(a);
	    a.click();
	    a.remove();
	    URL.revokeObjectURL(url);
	  }
 </script>
</html>

